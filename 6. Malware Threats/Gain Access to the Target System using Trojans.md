- Attackers use digital Trojan horses to trick the victim into performing a predefined action on a computer. Trojans are activated upon users’ specific predefined actions, like unintentionally installing a piece of malicious software or clicking on a malicious link, and upon activation, it can grant attackers unrestricted access to all data stored on compromised information systems and cause potentially immense damage. For example, users could download a file that appears to be a movie, but, when opened, it unleashes a dangerous program that erases the hard drive or sends credit card numbers and passwords to the attacker.
- Trojan horses work on the same level of privileges as victims. For example, if a victim has the privileges to delete files, transmit information, modify existing files, and install other programs (such as programs that provide unauthorized network access and execute privilege elevation attacks), once the Trojan infects that system, it will possess the same privileges. Furthermore, it can attempt to exploit vulnerabilities to increase its level of access, even beyond the user running it. If successful, the Trojan could use the increased privileges to install other malicious code on the victim’s machine.
- An expert security auditor or ethical hacker needs to ensure that the organization’s network is secure from Trojan attacks by finding machines vulnerable to these attacks and making sure that anti-virus tools are properly configured to detect such attacks.


### Gain Control over a Victim Machine using the njRAT RAT Trojan

- Attackers use Remote Access Trojans (RATs) to infect the target machine to gain administrative access. RATs help an attacker to remotely access the complete GUI and control the victim’s computer without his/her awareness. They can perform screening and camera capture, code execution, keylogging, file access, password sniffing, registry management, and other tasks. The virus infects victims via phishing attacks and drive-by downloads and propagates through infected USB keys or networked drives. It can download and execute additional malware, execute shell commands, read and write registry keys, capture screenshots, log keystrokes, and spy on webcams.

- njRAT is a RAT with powerful data-stealing capabilities. In addition to logging keystrokes, it is capable of accessing a victim’s camera, stealing credentials stored in browsers, uploading and downloading files, performing process and file manipulations, and viewing the victim’s desktop.

- This RAT can be used to control Botnets (networks of computers), allowing the attacker to update, uninstall, disconnect, restart, and close the RAT, and rename its campaign ID. The attacker can further create and configure the malware to spread through USB drives with the help of the Command and Control server software.
- Navigate to **Trojans Types\Remote Access Trojans (RAT)\njRAT** and double-click **njRAT v0.7d.exe**.
- The **njRAT GUI** appears along with an njRAT pop-up, where you need to specify the port you want to use to interact with the victim machine. Enter the port number and click **Start**.
	- here we choose default port number (5552)
- The njRAT GUI appears; click the **Builder** link located in the lower-left corner of the GUI to configure the exploit details.
	- The **Builder** dialog-box appears; enter the IP address of the **Windows 10** (attacker machine) machine in the **Host** field, check the option **Registy StarUp**, leave the other settings to default, and click **Build**.
	- In this lab, the destination location chosen is **Desktop**, and the file is named **Test.exe**.
	- **Now, use any technique to send this server to the intended target through email or any other source (in real-time, attackers send this server to the victim).**

- now in the victim's machine, we are acting both as an **attacker** who logs into the **Windows 10** machine to create a malicious server, and as a **victim** who logs into the **Windows Server 2016** machine and downloads the server.
- Double-click the server (**Test.exe**) to run this malicious executable.
- Now switch back to host machine. 
- As soon as the victim (here, you) double-clicks the server, the executable starts running and the njRAT client (njRAT GUI) running in **Windows 10** establishes a persistent connection with the victim machine.
- Unless the attacker working on the **Windows 10** machine disconnects the server on their own, the victim machine remains under their control.
- The GUI displays the machine’s basic details such as the IP address, User name, and Type of Operating system.
- Right-click on the detected victim name and click **Manager**.
- The **manager** window appears with **File Manager** selected by default.
	- Double-click any directory in the left pane (here, **ProgramData**); all its associated files and directories are displayed in the right pane. You can right-click a selected directory and manipulate it using the contextual options.
	- Click on **Process Manager**. You will be redirected to the Process Manager, where you can right-click on a selected process and perform actions such as **Kill**, **Delete**, and **Restart**.
	- Click on **Connections**, select a specific connection, right-click on it, and click **Kill Connection**. This kills the connection between two machines communicating through a particular port.
	- Click on **Registry**, choose a registry directory from the left pane, and right-click on its associated registry files.
	- A few options appear for the files; you can use these to manipulate them.
	- Click **Remote Shell**. This launches a remote command prompt for the victim machine (**Windows Server 2016**).
		> ipconfig/all (This displays all interfaces related to the victim machine)
		
			- Similarly, you can issue all other commands that can be executed in the command prompt of the victim machine.
    - In the same way, click **Services**. You will be able to view all services running on the victim machine. In this section, you can use options to **start**, **pause**, or **stop** a service.
- Now, right-click on the victim name, click **Run File**, and choose an option from the drop-down list to execute scripts or files remotely from the attacker machine.
- Right-click on the victim name, and then select **Remote Desktop**. This launches a remote Desktop connection
	- A remote desktop control panel appears; check the **Mouse** option. (to remotely interact with the victim machine using the mouse.)
	- If you want to create any files or write any scripts on the victim machine, you need to check the **Keyboard** option.
	- In the same way, right-click on the victim name, and select **Remote Cam** and **Microphone** to spy on them and track voice conversations.
- Even if the victim (you) attempts to break the connection by restarting the machine. As soon as this happens, njRAT loses its connection with **Windows Server 2016**, as the machine is shut down in the process of restarting.
- However, as soon as the victim logs in to their machine, the njRAT client automatically establishes a connection with the victim.








### Hide a Trojan using SwayzCryptor and Make it Undetectable to Various Anti-Virus Programs

- At present, numerous anti-virus software programs have been configured to detect malware such as Trojans, viruses, and worms. Although security specialists keep updating the virus definitions, hackers continually try to evade or bypass them. One method that attackers use to bypass AVs is to “crypt” (an abbreviation of “encrypt”) the malicious files using fully undetectable crypters (FUDs). Crypting these files allows them to achieve their objectives, and thereby take complete control over the victim’s machine.

- Crypter is a software that encrypts the original binary code of the .exe file to hide viruses, spyware, keyloggers, and RATs, among others, in any kind of file to make them undetectable by anti-viruses. SwayzCryptor is an encrypter (or “crypter”) that allows users to encrypt their program’s source code.


### Create a Server using the ProRat Tool

- Attackers use malware to steal personal information, financial data, and business information from target systems. ProRat is a “remote administration tool” created by the PRO Group. ProRat was written in the C programming language and is capable of working with all Windows OSes. ProRat was designed to allow users to control their own computers remotely from other computers. However, attackers have co-opted it for their own nefarious purposes. Some hackers take control of remote computer systems to conduct a Denial-of-Service (DoS) attack, which renders the target system unavailable for normal personal or business use. These targeted systems include high-profile web servers such as banks and credit card gateways.

- As with other Trojan horses, ProRat uses a client and server. It opens a port on the computer that allows the client to perform numerous operations on the server (the victim machine).


### Create a Trojan Server using Theef RAT Trojan

- Theef is a Remote Access Trojan written in Delphi. It allows remote attackers access to the system via port 9871. Theef is a Windows-based application for both client and server. The Theef server is a virus that you install on a target computer, and the Theef client is what you then use to control the virus.