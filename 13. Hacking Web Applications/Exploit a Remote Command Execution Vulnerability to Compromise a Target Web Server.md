
Damn Vulnerable Web App (DVWA) is a PHP/MySQL web application that is extremely vulnerable. The main objective of DVWA is to aid security professionals in testing their skills and tools in a legal environment, to help web developers better understand the processes of securing web applications, and to aid teachers and students in teaching and learning web application security in a classroom environment.

In this task, we will perform command-line execution on a vulnerability found in DVWA. Here, you will learn how to extract information about a target machine, create a user account, assign administrative privileges to the created account, and use that account to log in to the target machine.

1.  Click [Windows 10](https://labclient.labondemand.com/Instructions/8675f687-b2ff-4705-80c5-689a0153f10e?rc=10#) to switch to the **Windows 10** machine.
    
2.  Launch any browser, in this lab we are using **Mozilla Firefox**. In the address bar of the browser place your mouse cursor and click http://10.10.10.16:8080/dvwa/login.php and press **Enter**
    
    > The IP address of the **Windows Server 2016** in this lab is **10.10.10.16**, which might vary in your lab environment.
    
3.  The **DVWA** login page appears; type the **Username** and **Password** as **gordonb** and **abc123**. Click the **Login** button.
    
    > If a **Would you like Firefox to save this login** notification appears at the top of the browser window, click **Don’t Save**.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/hyc2atba.jpg)
    
4.  You are successfully logged in, and the **DVWA** main webpage appears. Click **Command Injection** from the options available in the left pane.
    
    ![ssss.png](https://labondemand.blob.core.windows.net/content/lab73327/ssss.png)
    
5.  The **Vulnerability: Command Injection** page appears; under the **Ping a device** section, type the IP address of the **Windows Server 2016** machine (here, **10.10.10.16**) into the **Enter an IP address** field and click the **Submit** button to ping the machine.
    
    > The command injection utility in DVWA allows you to ping the target machine.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/0jp5nb2e.jpg)
    
6.  **DVWA** successfully pings the target machine, as shown in the screenshot.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/gf3v5ely.jpg)
    
7.  Now, try to issue a different command to check whether **DVWA** can execute it.
    
8.  Type **| hostname** into the **Enter an IP address** field and click **Submit**. This command is used to probe the hostname of the target machine.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/jfzq4usd.jpg)
    
9.  As you have issued a command instead of entering the IP address of a machine, the application returns an error, as shown in the screenshot.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/guzutzd1.jpg)
    
10.  The result indicates that the DVWA application is secure.
    
11.  Now, check the security setting of the web application. To do so, click **DVWA Security** in the left pane.
    
12.  The **DVWA Security** page appears. Observe that the security level is **Impossible**. This security setting was blocking you from executing commands other than simply pinging a machine.
    
13.  Now, to exploit the command execution vulnerability, set the **Security Level** of the web application to low by selecting the option **Low** from the drop-down list and click **Submit**.
    
    > Here, your intention would be to show that a weakly secured web application is the prime focus of attackers, who seek to exploit its vulnerabilities.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/z24nzuz5.jpg)
    
14.  You have configured a weak security setting in DVWA. Now, try to execute a command other than ping.
    
15.  Click **Command Injection** from the left-pane.
    
16.  The **Vulnerability: Command Injection** page appears; type **| hostname** into the **Enter an IP address** field, and click **Submit**.
    
17.  **DVWA** returns the name of the **Windows Server 2016** machine, as shown in the screenshot.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/0d2ygkr5.jpg)
    
18.  This infers that the command execution field is vulnerable and that you can remotely execute commands.
    
19.  Now, extract more information regarding the target machine, **Windows Server 2016**.
    
20.  Type the command **| whoami** and click **Submit**.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/zom1fax4.jpg)
    
21.  The application displays the user, group, and privileges information for the user currently logged onto the **Windows Server 2016** machine, as shown in the screenshot.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/qcezm31k.jpg)
    
22.  Now, type **| tasklist**, and click **Submit** to view the processes running on the machine.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/uilq10gr.jpg)
    
23.  A list of all the running processes on the **Windows Server 2016** machine is displayed, as shown in the screenshot.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/0vgql2yi.jpg)
    
24.  To check if you can terminate a process, choose any process from the list (here, **Microsoft.ActiveDirectory**), and note down its process PID (here, **2172**).
    
    > The list of running processes might differ in your lab environment.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/oe3n2opt.jpg)
    
25.  Type **| Taskkill /PID [Process ID value of the desired process] /F** (here, PID is **2172**) and click **Submit**. By issuing this command, you are forcefully (**/F**) terminating the process.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/ntuzz1tn.jpg)
    
26.  The process will be successfully terminated, as shown in the screenshot.
    
    > To confirm that the process has successfully been terminated, you can issue the **| tasklist** command again to check the running processes.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/gwaxa5ln.jpg)
    
27.  Now, to view the directory structure of the **Windows Server 2016** machine, type **| dir C:\** and click **Submit** to view the files and directories on the **C:\** drive.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/pmgi53w1.jpg)
    
28.  The directory structure of the **C** drive of the target server (**Windows Server 2016**) is displayed, as shown in the screenshot.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/uguufkct.jpg)
    
29.  In the same way, you can issue commands to view other directories.
    
30.  Now, try to obtain information related to user accounts.
    
31.  To view user account information, type **| net user**, and click **Submit**.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/ascqrgcb.jpg)
    
32.  DVWA obtains user account information from the **Windows Server 2016** machine and lists, as shown in the screenshot.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/0hepj3hv.jpg)
    
33.  Now, use the command execution vulnerability and attempt to add a user account remotely.
    
34.  Create an account named **Test**. To do so, type **| net user Test /Add** and click **Submit**.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/hy02dqzz.jpg)
    
35.  The **command completed successfully** notification appears and a user account named **Test** is created.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/cq3wajfq.jpg)
    
36.  To view the new user account, type the command **| net user** and click **Submit**.
    
37.  You can observe the newly created account **Test**, as shown in the screenshot.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/iokidvfu.jpg)
    
38.  Now, view the new account’s information. Type **| net user Test** and click **Submit**.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/0swqcmsi.jpg)
    
39.  The **Test** account information appears. You can see that **Test** is a standard user account and does not have administrative privileges. You can see that it has an entry called **Local Group Memberships**.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/agptkype.jpg)
    
40.  Now, assign administrative privileges to the account. The reason for granting administrative privileges to this account is to use this (admin) account to log into the **Windows Server 2016** machine with administrator access using a remote desktop connection.
    
41.  To grant administrative privileges, type **| net localgroup Administrators Test /Add** and click **Submit**.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/i3qa2ylt.jpg)
    
42.  You have successfully granted admin privileges to the account. Confirm the new setting by issuing the command **| net user Test**. **Test** is now an administrator account under the **Local Group Memberships** option.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/e0niok4h.jpg)
    
43.  Now, log into the **Windows Server 2016** machine using the **Test** account through **Remote Desktop Connection**.
    
44.  Click the **Type here to search** field from the bottom of **Desktop** and type **Remote**. Click **Remote Desktop Connection** from the results.
    
45.  The **Remote Desktop Connection** window appears. In the **Computer** field, type the target system IP address (here, **10.10.10.16** [**Windows Server 2016**]) and click **Show Options**.
    
    ![1111.png](https://labondemand.blob.core.windows.net/content/lab73327/1111.png)
    
46.  The **Remote Desktop Connection** window appears with the **General** tab displayed; enter the **User name** as **test** and click **Connect**.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/izjm1xni.jpg)
    
47.  A **Windows Security** pop-up appears; leave the **Password** field empty and click **OK**.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/nicp1xvn.jpg)
    
48.  A **Remote Desktop Connection** window appears; click **Yes**.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/tvabxznd.jpg)
    
49.  A remote desktop connection is successfully established, as shown in the screenshot.
    
    > Thus, you have made use of a command execution vulnerability in a DVWA application hosted by the Windows Server 2016 machine, extracted information related to the machine, remotely created an administrator account, and logged into it.
    
    ![Screenshot](https://labondemand.blob.core.windows.net/content/lab73327/screens/kyfebzpg.jpg)
    
50.  Now, you may discontinue the session and log out of the web application. To do so, close the **Remote Desktop Connection** window. If a **Your** **remote session will be disconnected** notification appears, click **OK**.